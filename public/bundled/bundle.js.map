{
  "version": 3,
  "sources": ["../../src/support.ts", "../../src/types.ts", "../../src/utils.ts", "../../src/dom.ts", "../../src/common.ts", "../../src/draw.ts", "../../src/move.ts", "../../src/update-dom.ts", "../../src/events.ts", "../../src/index.ts"],
  "sourcesContent": ["// also see here\n// https://github.com/mdn/browser-compat-data/blob/227451e3120ee48a5f5cf2844083e65cba4df167/api/TextMetrics.json\nconst checkTMInterface = () => {\n  const props = [\n    'actualBoundingBoxAscent',\n    'actualBoundingBoxDescent',\n    'actualBoundingBoxLeft',\n    'actualBoundingBoxRight',\n\n    'fontBoundingBoxAscent',\n    'fontBoundingBoxDescent',\n\n    'emHeightAscent', // same as font\n    'emHeightDescent',\n\n    'alphabeticBaseline',\n    'hangingBaseline',\n    'ideographicBaseline',\n\n    'width',\n  ]\n\n  const supp: string[] = []\n  const nosupp: string[] = []\n\n  props.forEach((prop) =>\n    prop in TextMetrics.prototype ? supp.push(prop) : nosupp.push(prop),\n  )\n\n  console.log(\n    'Supported: %o. Not supported: %o',\n    supp.join(', '),\n    nosupp.join(', '),\n  )\n}\n\nexport { checkTMInterface }\n", "declare global {\n  var queryLocalFonts: (() => Promise<FontData[]>) | undefined\n}\n\nexport enum Align {\n  START = 'start',\n  CENTER = 'center',\n  END = 'end',\n}\n\nexport enum Baseline {\n  ALPHABETIC = 'alphabetic',\n  BOTTOM = 'bottom',\n  HANGING = 'hanging',\n  IDEOGRAPHIC = 'ideographic',\n  MIDDLE = 'middle',\n  TOP = 'top',\n}\n\nexport interface ILineStyle {\n  width: number\n  color: string\n  display: boolean\n}\n\nexport interface IAdditionalBlStyle {\n  display: boolean\n}\n\nexport enum Fw {\n  w100 = '100',\n  w200 = '200',\n  w300 = '300',\n  w400 = '400',\n  w500 = '500',\n  w600 = '600',\n  w700 = '700',\n  w800 = '800',\n  w900 = '900',\n}\n\nexport interface IMetrix {\n  text: string\n  font: {\n    ff: string\n    fs: string\n    useItalic: boolean\n    useWeight: boolean\n    useFs: boolean\n    fw: Fw\n    size: number\n    lh: number\n    align: Align\n    baseline: Baseline\n  }\n  props: {\n    rw: number\n    rh: number\n\n    drawX: number\n    drawY: number\n\n    scaleMp: number\n\n    rr: number\n    style: {\n      actualBb: ILineStyle\n      fontBb: ILineStyle\n      blAlign: ILineStyle\n      alphabeticBl: IAdditionalBlStyle\n      hangingBl: IAdditionalBlStyle\n      ideographicBl: IAdditionalBlStyle\n    }\n\n    shared: {\n      cw: number\n      ch: number\n      fm: FontMap\n      ctx: CanvasRenderingContext2D\n    }\n  }\n}\n\ninterface IFontData {\n  family: string\n  fullName: string\n  postscriptName: string\n  style: string\n  blob: () => Promise<Blob>\n}\n\nexport type FontData = Readonly<IFontData>\n\nexport type BuiltinFontData = Pick<\n  FontData,\n  'family' | 'fullName' | 'postscriptName' | 'style'\n>\n\nexport interface IFont {\n  fullName: string\n  postscriptName: string\n  style: string\n}\n\nexport type FontMap = {\n  [key: string]: IFont[] | undefined\n}\n\n// Manually extend TM interface with safari-only props\nexport interface IExtendedTextMetrics extends TextMetrics {\n  alphabeticBaseline?: number\n  hangingBaseline?: number\n  ideographicBaseline?: number\n}\n", "import { BuiltinFontData, FontMap, IMetrix } from './types'\n\nconst debounce = (fn: (...args: unknown[]) => unknown, delay: number) => {\n  let t: null | number = null\n\n  return (...args: unknown[]) => {\n    typeof t === 'number' && clearTimeout(t)\n\n    t = setTimeout(() => {\n      fn(...args)\n    }, delay)\n  }\n}\n\nconst validateEnumValue = <T>(\n  value: string,\n  enumObj: {\n    [k: string]: T | string\n  },\n): T => {\n  const values = Object.values(enumObj)\n\n  if (values.includes(value)) {\n    return value as T\n  }\n  console.warn(\n    '%o does not exist in enum %o. Using %o',\n    value,\n    enumObj,\n    values[0],\n  )\n  return values[0] as T\n}\n\nconst te: (msg?: string, err?: ErrorConstructor) => never = (\n  msg = 'Unknown',\n  err = Error,\n) => {\n  throw new err(msg)\n}\n\nconst getFontString = (m: IMetrix, size?: number): string => {\n  return `${m.font.useItalic ? 'italic' : 'normal'} ${\n    m.font.useWeight ? m.font.fw : ''\n  } ${size ?? m.font.size}px ${m.font.useFs ? m.font.fs : m.font.ff}`\n}\n\nconst getFonts = (fd: readonly BuiltinFontData[]) => {\n  const fontMap: FontMap = fd.reduce(\n    (acc: FontMap, { family, fullName, style, postscriptName }) => {\n      let record = acc[family] || (acc[family] = [])\n\n      record.push({ fullName, style, postscriptName })\n\n      return acc\n    },\n    {},\n  )\n\n  const validateFontMap = (fm: FontMap) => {\n    Object.entries(fm).forEach(([k, v]) => {\n      if (v) {\n        if (v.length === 0) {\n          console.warn('%o font record has no variants', k)\n        }\n      } else {\n        console.warn('%o font record missing value', k)\n      }\n    })\n  }\n\n  validateFontMap(fontMap)\n\n  return fontMap\n}\n\nexport { debounce, validateEnumValue, te, getFontString, getFonts }\n", "import { te } from './utils'\n\nconst q = <T extends Element = Element>(qs: string) =>\n  document.querySelector<T>(qs) ?? te(`dom el missing (selector: ${qs})`)\n\nconst dom = {\n  mainCss: q<HTMLLinkElement>('.main-css'),\n\n  textInput: q<HTMLTextAreaElement>('.text-input'),\n  ffInput: q<HTMLSelectElement>('.ff-input'),\n  useFsInput: q<HTMLInputElement>('.use-fs-input'),\n  fsInput: q<HTMLSelectElement>('.fs-input'),\n  useItalicInput: q<HTMLInputElement>('.use-italic-input'),\n  useWeightInput: q<HTMLInputElement>('.use-weight-input'),\n  fwInput: q<HTMLSelectElement>('.fw-input'),\n  localFontsButton: q<HTMLButtonElement>('.local-fonts-button'),\n  fontSizeInput: q<HTMLInputElement>('.font-size-input'),\n  fontSizeValue: q<HTMLSpanElement>('.font-size-value'),\n  lhInput: q<HTMLInputElement>('.line-height-input'),\n  lhValue: q<HTMLSpanElement>('.line-height-value'),\n  alignInput: q<HTMLSelectElement>('.align-input'),\n  baselineInput: q<HTMLSelectElement>('.baseline-input'),\n\n  canvas: q<HTMLCanvasElement>('.canvas canvas'),\n  canvasUi: q<HTMLDivElement>('.canvas-ui'),\n\n  rrValue: q<HTMLSpanElement>('.rr-value'),\n  dprValue: q<HTMLSpanElement>('.dpr-value'),\n  rrInput: q<HTMLInputElement>('.rr-input'),\n  canvasSizeValue: q<HTMLSpanElement>('.canvas-size-value'),\n  renderPixelValue: q<HTMLSpanElement>('.render-pixel-value'),\n  zoomValue: q<HTMLSpanElement>('.zoom-value'),\n  lineStyle: {\n    blAlign: {\n      color: q<HTMLInputElement>('.bl-align-color-input'),\n      width: q<HTMLInputElement>('.bl-align-width-input'),\n      display: q<HTMLInputElement>('.bl-align-display-input'),\n    },\n    fontBb: {\n      color: q<HTMLInputElement>('.font-color-input'),\n      width: q<HTMLInputElement>('.font-width-input'),\n      display: q<HTMLInputElement>('.font-display-input'),\n    },\n    actualBb: {\n      color: q<HTMLInputElement>('.actual-color-input'),\n      width: q<HTMLInputElement>('.actual-width-input'),\n      display: q<HTMLInputElement>('.actual-display-input'),\n    },\n    alphabeticBl: {\n      display: q<HTMLInputElement>('.alphabetic-bl-display-input'),\n    },\n    hangingBl: {\n      display: q<HTMLInputElement>('.hanging-bl-display-input'),\n    },\n    ideographicBl: {\n      display: q<HTMLInputElement>('.ideographic-bl-display-input'),\n    },\n  },\n} as const\n\nexport { dom }\n", "import { BuiltinFontData } from './types'\n\nexport const builtinFontData: readonly BuiltinFontData[] = [\n  {\n    postscriptName: 'serif',\n    fullName: 'Browser serif',\n    family: 'serif',\n    style: '(browser)',\n  },\n  {\n    postscriptName: 'sans-serif',\n    fullName: 'Browser sans-serif',\n    family: 'sans-serif',\n    style: '(browser)',\n  },\n  {\n    postscriptName: 'monospace',\n    fullName: 'Browser monospace',\n    family: 'monospace',\n    style: '(browser)',\n  },\n] as const\n\nexport const mlOffset = 30\nexport const mtOffset = 10\n\nexport const addBlProps = [\n  { dProp: 'alphabeticBl', mProp: 'alphabeticBaseline' },\n  { dProp: 'ideographicBl', mProp: 'ideographicBaseline' },\n  { dProp: 'hangingBl', mProp: 'hangingBaseline' },\n] as const\n\nexport const colors = {\n  background: '#202020',\n  color: '#cecece',\n}\n", "import { addBlProps, mlOffset, mtOffset } from './common'\nimport { IExtendedTextMetrics, IMetrix } from './types'\nimport { getFontString } from './utils'\n\nconst init = (m: IMetrix) => {\n  const ctx = m.props.shared.ctx\n  const cw = ctx.canvas.clientWidth\n  const ch = ctx.canvas.clientHeight\n\n  m.props.rw = cw / m.props.scaleMp\n  m.props.rh = ch / m.props.scaleMp\n\n  ctx.canvas.width = cw * m.props.rr\n  ctx.canvas.height = ch * m.props.rr\n\n  ctx.scale(m.props.rr * m.props.scaleMp, m.props.rr * m.props.scaleMp)\n\n  m.props.shared.cw = cw\n  m.props.shared.ch = ch\n}\n\nconst drawSync = (m: IMetrix) => {\n  const {\n    rw,\n    rh,\n    shared: { ctx },\n  } = m.props\n\n  const drawText = (\n    line: string,\n    dx: number,\n    dy: number,\n  ): IExtendedTextMetrics => {\n    ctx.save()\n    ctx.textAlign = m.font.align\n    ctx.textBaseline = m.font.baseline\n    ctx.font = getFontString(m)\n    ctx.fillText(line, dx, dy)\n    const mets = ctx.measureText(line) as IExtendedTextMetrics\n    ctx.restore()\n\n    return mets\n  }\n\n  const drawBlAlign = (idx: number, dx: number, dy: number) => {\n    const blAlignPath = new Path2D()\n    blAlignPath.moveTo(0, dy)\n    blAlignPath.lineTo(rw, dy)\n\n    // draw idx-independent lines once\n    if (idx === 0) {\n      blAlignPath.moveTo(dx, 0)\n      blAlignPath.lineTo(dx, rh)\n    }\n\n    ctx.save()\n    ctx.strokeStyle = m.props.style.blAlign.color\n    ctx.lineWidth = m.props.style.blAlign.width\n    ctx.stroke(blAlignPath)\n    ctx.restore()\n  }\n\n  const drawFontBb = (\n    idx: number,\n    mets: TextMetrics,\n    dx: number,\n    dy: number,\n  ) => {\n    const fPath = new Path2D()\n    fPath.moveTo(0, dy - mets.fontBoundingBoxAscent)\n    fPath.lineTo(rw, dy - mets.fontBoundingBoxAscent)\n    fPath.moveTo(0, dy + mets.fontBoundingBoxDescent)\n    fPath.lineTo(rw, dy + mets.fontBoundingBoxDescent)\n\n    ctx.save()\n    ctx.strokeStyle = m.props.style.fontBb.color\n    ctx.lineWidth = m.props.style.fontBb.width\n    ctx.stroke(fPath)\n    ctx.restore()\n  }\n\n  const drawActualBb = (\n    idx: number,\n    mets: TextMetrics,\n    dx: number,\n    dy: number,\n  ) => {\n    // h\n    const aPath = new Path2D()\n    aPath.moveTo(0, dy - mets.actualBoundingBoxAscent)\n    aPath.lineTo(rw, dy - mets.actualBoundingBoxAscent)\n    aPath.moveTo(0, dy + mets.actualBoundingBoxDescent)\n    aPath.lineTo(rw, dy + mets.actualBoundingBoxDescent)\n\n    // v\n    // draw idx-independent Y lines once\n    if (idx === 0) {\n      aPath.moveTo(dx - mets.actualBoundingBoxLeft, 0) // this can return negative for left-aligned text\n      aPath.lineTo(dx - mets.actualBoundingBoxLeft, rh)\n    }\n    aPath.moveTo(dx + mets.actualBoundingBoxRight, 0)\n    aPath.lineTo(dx + mets.actualBoundingBoxRight, rh)\n\n    ctx.save()\n    ctx.strokeStyle = m.props.style.actualBb.color\n    ctx.lineWidth = m.props.style.actualBb.width\n    ctx.stroke(aPath)\n    ctx.restore()\n  }\n\n  let lastMLYTop = 0\n\n  const drawMl = (idx: number, mets: TextMetrics, dx: number, dy: number) => {\n    // measuring line\n    const p = new Path2D()\n    const totalMlOffset = mlOffset / m.props.scaleMp\n    const totalMtOffset = mtOffset / m.props.scaleMp\n\n    const horMLY =\n      (idx === 0 ? dy - mets.actualBoundingBoxAscent : lastMLYTop) -\n      totalMlOffset\n    const verMLx = dx + mets.actualBoundingBoxRight + totalMlOffset\n\n    p.moveTo(dx - mets.actualBoundingBoxLeft, horMLY)\n    p.lineTo(dx + mets.actualBoundingBoxRight, horMLY)\n    p.moveTo(verMLx, dy - mets.actualBoundingBoxAscent)\n    p.lineTo(verMLx, dy + mets.actualBoundingBoxDescent)\n\n    ctx.save()\n    ctx.strokeStyle = m.props.style.actualBb.color\n    ctx.lineWidth = m.props.style.actualBb.width\n    ctx.save() // save before alpha\n    ctx.globalAlpha = 0.5\n    ctx.stroke(p)\n    ctx.restore() // restore alpha\n\n    // measuring line text\n    ctx.textAlign = 'center'\n    ctx.textBaseline = 'bottom'\n    ctx.font = getFontString(m, m.font.size / 2)\n\n    const w = mets.actualBoundingBoxLeft + mets.actualBoundingBoxRight\n    const horX = dx - mets.actualBoundingBoxLeft + w / 2\n    const horY = horMLY - totalMtOffset\n    ctx.fillText(`${w.toFixed(1)}px`, horX, horY)\n\n    const h = mets.actualBoundingBoxAscent + mets.actualBoundingBoxDescent\n    const verX = verMLx + totalMtOffset\n    const verY = dy - mets.actualBoundingBoxAscent + h / 2\n    ctx.save() // save before transform\n    ctx.translate(verX, verY)\n    ctx.rotate(90 / (180 / Math.PI))\n    ctx.fillText(`${h.toFixed(1)}px`, 0, 0)\n    ctx.restore() // restore transform\n\n    ctx.textAlign = 'end'\n    ctx.fillText(\n      `(${mets.width.toFixed(1)}px/${\n        mets.fontBoundingBoxAscent + mets.fontBoundingBoxDescent\n      }px)`,\n      dx - totalMtOffset,\n      dy,\n    )\n    ctx.restore() // restore rest\n\n    // top point of text above hor line\n    lastMLYTop = horY - m.font.size / 2\n  }\n\n  const drawAdditionalBl = (\n    idx: number,\n    mets: IExtendedTextMetrics,\n    dx: number,\n    dy: number,\n  ) => {\n    addBlProps.forEach(({ dProp, mProp }) => {\n      if (!m.props.style[dProp].display) {\n        return\n      }\n      const blPath = new Path2D()\n      blPath.moveTo(0, dy - (mets[mProp] || 0))\n      blPath.lineTo(rw, dy - (mets[mProp] || 0))\n\n      ctx.save()\n      ctx.strokeStyle = m.props.style.blAlign.color\n      ctx.lineWidth = m.props.style.blAlign.width\n      ctx.stroke(blPath)\n      ctx.restore()\n    })\n  }\n\n  ctx.clearRect(0, 0, rw, rh)\n\n  const lines = m.text.split('\\n')\n\n  lines.forEach((line, idx) => {\n    const dx = m.props.drawX\n    const dy = m.props.drawY + m.font.lh * idx\n\n    const mets = drawText(line, dx, dy)\n\n    ctx.save()\n    ctx.globalAlpha = 0.5\n    m.props.style.blAlign.display && drawBlAlign(idx, dx, dy)\n    m.props.style.fontBb.display && drawFontBb(idx, mets, dx, dy)\n    m.props.style.actualBb.display && drawActualBb(idx, mets, dx, dy)\n\n    drawAdditionalBl(idx, mets, dx, dy)\n    ctx.restore() // restore alpha\n\n    m.props.style.actualBb.display && drawMl(idx, mets, dx, dy)\n  })\n}\n\nlet af: number | null = null\n\nconst draw = (...args: Parameters<typeof drawSync>) => {\n  typeof af === 'number' && cancelAnimationFrame(af)\n  af = requestAnimationFrame(drawSync.bind(null, ...args))\n}\n\nexport { draw, init }\n", "const addMove = ({\n  ui,\n  onDown,\n  onMove,\n  onUp,\n  onWheel,\n}: {\n  /** Attaches down listener to this element */\n  ui: HTMLElement\n  onDown: () => void\n  /** Provides clientX/clientY based delta relative to the latest move (NOT relative to the down origin) */\n  onMove: (dx: number, dy: number) => void\n  onUp: () => void\n  onWheel: (dx: number, dy: number, ev: MouseEvent) => void\n}) => {\n  let eventsAdded = false\n  let lastX: number\n  let lastY: number\n\n  const handleUp = () => {\n    removeMoveEvents()\n    onUp()\n  }\n\n  const handleMove = (evt: MouseEvent) => {\n    if (evt.buttons === 0) {\n      // ok to happen once on button release, otherwise user input sequence was somehow broken\n      // therefore remove events manually\n      handleUp()\n      return\n    }\n    evt.preventDefault()\n    const dx = evt.clientX - lastX\n    const dy = evt.clientY - lastY\n\n    onMove(dx, dy)\n\n    lastX = evt.clientX\n    lastY = evt.clientY\n  }\n\n  const addMoveEvents = () => {\n    if (eventsAdded) {\n      console.warn('Events are already added')\n      return\n    }\n    window.addEventListener('mousemove', handleMove)\n    window.addEventListener('mouseup', handleUp)\n    eventsAdded = true\n  }\n\n  const removeMoveEvents = () => {\n    window.removeEventListener('mousemove', handleMove)\n    window.removeEventListener('mouseup', handleUp)\n    eventsAdded = false\n  }\n\n  ui.addEventListener('mousedown', (evt) => {\n    evt.preventDefault()\n\n    lastX = evt.clientX\n    lastY = evt.clientY\n\n    addMoveEvents()\n    onDown()\n  })\n\n  ui.addEventListener('contextmenu', (evt) => {\n    evt.preventDefault()\n  })\n\n  ui.addEventListener('wheel', (evt) => {\n    evt.preventDefault()\n\n    onWheel(evt.deltaX, evt.deltaY, evt)\n  })\n}\n\nexport { addMove }\n", "import { dom } from './dom'\nimport { IFont, IMetrix } from './types'\nimport { te } from './utils'\n\nconst getOptsFromArr = (arr: IFont[] | string[]): HTMLOptionElement[] => {\n  return arr.map((item) => {\n    const opt = document.createElement('option')\n    if (typeof item === 'string') {\n      opt.value = item\n      opt.innerHTML = item\n    } else {\n      opt.value = item.postscriptName\n      opt.innerHTML = item.style\n      opt.title = item.fullName\n    }\n    return opt\n  })\n}\n\nconst updateCanvasRes = (m: IMetrix) => {\n  dom.canvasSizeValue.innerHTML =\n    m.props.rw.toFixed(1) + 'x' + m.props.rh.toFixed(1)\n  dom.renderPixelValue.innerHTML =\n    (m.props.rw * m.props.rr).toFixed(1) +\n    'x' +\n    (m.props.rh * m.props.rr).toFixed(1)\n}\n\nconst updateTextInputStyle = (m: IMetrix) => {\n  dom.textInput.style.fontFamily = m.font.useFs ? m.font.fs : m.font.ff\n  dom.textInput.style.fontStyle = m.font.useItalic ? 'italic' : 'normal'\n  dom.textInput.style.fontWeight = m.font.useWeight ? m.font.fw : ''\n}\n\nconst updateFf = (m: IMetrix) => {\n  dom.ffInput.innerHTML = ''\n  dom.ffInput.append(...getOptsFromArr(Object.keys(m.props.shared.fm)))\n  dom.ffInput.value = m.font.ff\n}\n\nconst updateFs = (m: IMetrix, reset: boolean = false) => {\n  const record =\n    m.props.shared.fm[m.font.ff] ?? te('Selected font-family is not in fontmap')\n\n  dom.fsInput.innerHTML = ''\n  dom.fsInput.append(...getOptsFromArr(record))\n\n  if (reset) {\n    m.font.fs = record[0].postscriptName\n  }\n\n  const availableValues = record.map(({ postscriptName }) => postscriptName)\n  if (!availableValues.includes(m.font.fs)) {\n    console.warn(\n      '%o is not in available styles list. Who tf set that?',\n      m.font.fs,\n    )\n  }\n\n  dom.fsInput.value = m.font.fs\n}\n\nconst updateDom = (M: IMetrix) => {\n  dom.textInput.value = M.text\n  updateTextInputStyle(M)\n  updateFf(M)\n  updateFs(M)\n  dom.useFsInput.checked = M.font.useFs\n  dom.fsInput.disabled = !dom.useFsInput.checked\n  dom.useItalicInput.checked = M.font.useItalic\n  dom.useWeightInput.checked = M.font.useWeight\n  dom.fwInput.value = M.font.fw\n  dom.fwInput.disabled = !dom.useWeightInput.checked\n\n  dom.fontSizeInput.value = String(M.font.size)\n  dom.fontSizeValue.innerHTML = String(M.font.size)\n  dom.lhInput.value = String(M.font.lh)\n  dom.lhValue.innerHTML = String(M.font.lh)\n  dom.alignInput.value = M.font.align\n  dom.baselineInput.value = M.font.baseline\n\n  dom.rrValue.innerHTML = String(M.props.rr)\n  dom.dprValue.innerHTML = String(window.devicePixelRatio)\n  dom.rrInput.value = String(M.props.rr)\n  updateCanvasRes(M)\n  dom.zoomValue.innerHTML = String(M.props.scaleMp)\n\n  dom.lineStyle.blAlign.color.value = M.props.style.blAlign.color\n  dom.lineStyle.blAlign.width.value = String(M.props.style.blAlign.width)\n  dom.lineStyle.blAlign.display.checked = M.props.style.blAlign.display\n  dom.lineStyle.fontBb.color.value = M.props.style.fontBb.color\n  dom.lineStyle.fontBb.width.value = String(M.props.style.fontBb.width)\n  dom.lineStyle.fontBb.display.checked = M.props.style.fontBb.display\n  dom.lineStyle.actualBb.color.value = M.props.style.actualBb.color\n  dom.lineStyle.actualBb.width.value = String(M.props.style.actualBb.width)\n  dom.lineStyle.actualBb.display.checked = M.props.style.actualBb.display\n\n  dom.lineStyle.alphabeticBl.display.disabled = !(\n    'alphabeticBaseline' in TextMetrics.prototype\n  )\n  dom.lineStyle.hangingBl.display.disabled = !(\n    'hangingBaseline' in TextMetrics.prototype\n  )\n  dom.lineStyle.ideographicBl.display.disabled = !(\n    'ideographicBaseline' in TextMetrics.prototype\n  )\n\n  dom.lineStyle.alphabeticBl.display.checked =\n    M.props.style.alphabeticBl.display\n  dom.lineStyle.ideographicBl.display.checked =\n    M.props.style.ideographicBl.display\n  dom.lineStyle.hangingBl.display.checked = M.props.style.hangingBl.display\n}\n\nexport { updateDom, updateCanvasRes, updateTextInputStyle, updateFf, updateFs }\n", "import { builtinFontData } from './common'\nimport { dom } from './dom'\nimport { draw, init } from './draw'\nimport { addMove } from './move'\nimport { Align, Baseline, FontData, Fw, IMetrix } from './types'\nimport {\n  updateCanvasRes,\n  updateFf,\n  updateFs,\n  updateTextInputStyle,\n} from './update-dom'\nimport { getFonts, validateEnumValue } from './utils'\n\nconst addEvents = (m: IMetrix) => {\n  dom.textInput.addEventListener('input', () => {\n    m.text = dom.textInput.value\n    draw(m)\n  })\n\n  dom.ffInput.addEventListener('change', () => {\n    m.font.ff = dom.ffInput.value\n    updateFs(m, true)\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.useFsInput.addEventListener('change', () => {\n    m.font.useFs = dom.useFsInput.checked\n    dom.fsInput.disabled = !dom.useFsInput.checked\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.fsInput.addEventListener('change', () => {\n    m.font.fs = dom.fsInput.value\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.useItalicInput.addEventListener('change', () => {\n    m.font.useItalic = dom.useItalicInput.checked\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.useWeightInput.addEventListener('change', () => {\n    m.font.useWeight = dom.useWeightInput.checked\n    dom.fwInput.disabled = !dom.useWeightInput.checked\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.fwInput.addEventListener('change', () => {\n    m.font.fw = validateEnumValue<Fw>(dom.fwInput.value, Fw)\n    updateTextInputStyle(m)\n    draw(m)\n  })\n\n  dom.localFontsButton.addEventListener('click', () => {\n    const updateLocalFonts = (fd: FontData[]) => {\n      m.props.shared.fm = getFonts(builtinFontData.concat(fd))\n      updateFf(m)\n      updateFs(m)\n    }\n\n    if (window.queryLocalFonts) {\n      window\n        .queryLocalFonts()\n        .then((data: FontData[]) => {\n          if (data.length === 0) {\n            console.warn(\n              'Empty array, permission denied. Enable manually in browser',\n            )\n          } else {\n            updateLocalFonts(data)\n          }\n        })\n        .catch((reason: Error) => {\n          console.error('Local fonts query failed: %o', reason)\n        })\n    } else {\n      console.warn('Local fonts not supported')\n    }\n  })\n\n  dom.fontSizeInput.addEventListener('input', () => {\n    m.font.size = Number(dom.fontSizeInput.value)\n    dom.fontSizeValue.innerHTML = dom.fontSizeInput.value\n    draw(m)\n  })\n\n  dom.lhInput.addEventListener('input', () => {\n    m.font.lh = Number(dom.lhInput.value)\n    dom.lhValue.innerHTML = dom.lhInput.value\n    draw(m)\n  })\n\n  dom.alignInput.addEventListener('change', () => {\n    m.font.align = validateEnumValue<Align>(dom.alignInput.value, Align)\n    draw(m)\n  })\n\n  dom.baselineInput.addEventListener('change', () => {\n    m.font.baseline = validateEnumValue<Baseline>(\n      dom.baselineInput.value,\n      Baseline,\n    )\n    draw(m)\n  })\n\n  dom.rrInput.addEventListener('input', () => {\n    const value = dom.rrInput.value\n\n    dom.rrValue.innerHTML = value\n    m.props.rr = Number(value)\n    init(m) // rescaling required\n    updateCanvasRes(m)\n\n    draw(m)\n  })\n\n  window.addEventListener('resize', () => {\n    init(m)\n    updateCanvasRes(m)\n\n    draw(m)\n  })\n\n  const styleProps = ['blAlign', 'fontBb', 'actualBb'] as const\n\n  styleProps.forEach((prop) => {\n    dom.lineStyle[prop].color.addEventListener('input', () => {\n      m.props.style[prop].color = dom.lineStyle[prop].color.value\n      draw(m)\n    })\n    dom.lineStyle[prop].width.addEventListener('input', () => {\n      m.props.style[prop].width = Number(dom.lineStyle[prop].width.value)\n      draw(m)\n    })\n    dom.lineStyle[prop].display.addEventListener('input', () => {\n      m.props.style[prop].display = dom.lineStyle[prop].display.checked\n      draw(m)\n    })\n  })\n\n  const blStyleProps = ['alphabeticBl', 'hangingBl', 'ideographicBl'] as const\n\n  blStyleProps.forEach((prop) => {\n    dom.lineStyle[prop].display.addEventListener('input', () => {\n      m.props.style[prop].display = dom.lineStyle[prop].display.checked\n      draw(m)\n    })\n  })\n\n  // Overall scale (zoom) level, stored as a linear value\n  let scaleLin = 0\n\n  addMove({\n    ui: dom.canvasUi,\n    onDown: () => {\n      dom.canvasUi.classList.add('grabbing')\n    },\n    onMove: (dx, dy) => {\n      m.props.drawX += dx / m.props.scaleMp\n      m.props.drawY += dy / m.props.scaleMp\n\n      draw(m)\n    },\n    onUp: () => {\n      dom.canvasUi.classList.remove('grabbing')\n    },\n    onWheel: (dx, dy, evt) => {\n      // auto-set when pinching on os x\n      if (evt.ctrlKey) {\n        scaleLin += -dy / 100\n\n        const scaleExp = Math.pow(1.4, scaleLin)\n\n        m.props.scaleMp = scaleExp\n\n        dom.zoomValue.innerHTML = m.props.scaleMp.toFixed(2)\n\n        const xBefore = m.props.rw * (evt.offsetX / m.props.shared.cw)\n        const yBefore = m.props.rh * (evt.offsetY / m.props.shared.ch)\n\n        init(m)\n\n        const xAfter = m.props.rw * (evt.offsetX / m.props.shared.cw)\n        const yAfter = m.props.rh * (evt.offsetY / m.props.shared.ch)\n\n        m.props.drawX += xAfter - xBefore\n        m.props.drawY += yAfter - yBefore\n      } else {\n        m.props.drawX -= dx / m.props.scaleMp\n        m.props.drawY -= dy / m.props.scaleMp\n      }\n      draw(m)\n    },\n  })\n}\n\nexport { addEvents }\n", "import { checkTMInterface } from './support'\nimport { Align, Baseline, Fw, IMetrix } from './types'\nimport { dom } from './dom'\nimport { addEvents } from './events'\nimport { getFonts, te } from './utils'\nimport { updateDom } from './update-dom'\nimport { builtinFontData } from './common'\nimport { draw, init } from './draw'\nimport './style.css'\n\nconst ctx = dom.canvas.getContext('2d') ?? te('ctx died')\n\nconst fm = getFonts(builtinFontData)\n\nconst defFf = 'sans-serif'\nconst defFont = fm[defFf] ?? te('Default font family not found')\n\nconst metrix: IMetrix = {\n  text: 'my honest reaction \uD83D\uDE05\uD83D\uDC4C\uD83C\uDFFD',\n  font: {\n    fs: defFont[0].postscriptName,\n    useItalic: false,\n    useWeight: false,\n    useFs: true,\n    fw: Fw.w400,\n    ff: defFf,\n    size: 60,\n    lh: 80,\n    align: Align.START,\n    baseline: Baseline.ALPHABETIC,\n  },\n  props: {\n    rw: 0,\n    rh: 0,\n    drawX: 0,\n    drawY: 0,\n    scaleMp: 1,\n    rr: window.devicePixelRatio,\n    style: {\n      blAlign: { color: '#c800c8', width: 0.5, display: true },\n      fontBb: { color: '#f00000', width: 0.5, display: true },\n      actualBb: { color: '#000000', width: 0.5, display: true },\n      alphabeticBl: { display: false },\n      hangingBl: { display: false },\n      ideographicBl: { display: false },\n    },\n    shared: {\n      cw: 0,\n      ch: 0,\n      fm,\n      ctx,\n    },\n  },\n}\n\nconst setInitials = () => {\n  // Here goes whatever requires style's loaded state\n\n  metrix.props.drawX = 100\n  metrix.props.drawY = dom.canvas.clientHeight - 100\n}\n\nconst initApp = () => {\n  setInitials()\n\n  init(metrix)\n  draw(metrix)\n\n  addEvents(metrix)\n  updateDom(metrix)\n\n  checkTMInterface()\n}\n\nif (dom.mainCss.sheet) {\n  initApp()\n} else {\n  // Stylesheet can be NOT loaded yet, this happens in Safari only\n  // expect 'sheet' to be undefined\n  dom.mainCss.addEventListener('load', initApp)\n}\n"],
  "mappings": "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",
  "names": ["checkTMInterface", "props", "supp", "nosupp", "prop", "Align", "Baseline", "Fw", "validateEnumValue", "value", "enumObj", "values", "te", "msg", "err", "getFontString", "m", "size", "getFonts", "fd", "fontMap", "acc", "family", "fullName", "style", "postscriptName", "fm", "k", "v", "q", "qs", "te", "dom", "builtinFontData", "mlOffset", "mtOffset", "addBlProps", "init", "m", "ctx", "cw", "ch", "drawSync", "rw", "rh", "drawText", "line", "dx", "dy", "getFontString", "mets", "drawBlAlign", "idx", "blAlignPath", "drawFontBb", "fPath", "drawActualBb", "aPath", "lastMLYTop", "drawMl", "p", "totalMlOffset", "mlOffset", "totalMtOffset", "mtOffset", "horMLY", "verMLx", "w", "horX", "horY", "h", "verX", "verY", "drawAdditionalBl", "addBlProps", "dProp", "mProp", "blPath", "af", "draw", "args", "addMove", "ui", "onDown", "onMove", "onUp", "onWheel", "eventsAdded", "lastX", "lastY", "handleUp", "removeMoveEvents", "handleMove", "evt", "dx", "dy", "addMoveEvents", "getOptsFromArr", "arr", "item", "opt", "updateCanvasRes", "m", "dom", "updateTextInputStyle", "updateFf", "updateFs", "reset", "record", "te", "postscriptName", "updateDom", "M", "addEvents", "m", "dom", "draw", "updateFs", "updateTextInputStyle", "validateEnumValue", "Fw", "updateLocalFonts", "fd", "getFonts", "builtinFontData", "updateFf", "data", "reason", "Align", "Baseline", "value", "init", "updateCanvasRes", "prop", "scaleLin", "addMove", "dx", "dy", "evt", "scaleExp", "xBefore", "yBefore", "xAfter", "yAfter", "ctx", "dom", "te", "fm", "getFonts", "builtinFontData", "defFf", "defFont", "metrix", "setInitials", "initApp", "init", "draw", "addEvents", "updateDom", "checkTMInterface"]
}
