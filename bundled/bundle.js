"use strict";(()=>{var Y=()=>{let t=["actualBoundingBoxAscent","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","emHeightAscent","emHeightDescent","alphabeticBaseline","hangingBaseline","ideographicBaseline","width"],p=[],d=[];t.forEach(n=>n in TextMetrics.prototype?p.push(n):d.push(n)),console.log("Supported: %o. Not supported: %o",p.join(", "),d.join(", "))};var b=(n=>(n.START="start",n.CENTER="center",n.END="end",n))(b||{}),B=(f=>(f.ALPHABETIC="alphabetic",f.BOTTOM="bottom",f.HANGING="hanging",f.IDEOGRAPHIC="ideographic",f.MIDDLE="middle",f.TOP="top",f))(B||{});var S=(t,p)=>{let d=Object.values(p);return d.includes(t)?t:(console.warn("%o does not exist in enum %o. Using %o",t,p,d[0]),d[0])},x=(t="Unknown",p=Error)=>{throw new p(t)};var i=t=>document.querySelector(t)??x(`dom el missing (selector: ${t})`),e={textInput:i(".text-input"),ffInput:i(".font-family-input"),localFontsButton:i(".local-fonts-button"),fontSizeInput:i(".font-size-input"),fontSizeValue:i(".font-size-value"),lhInput:i(".line-height-input"),lhValue:i(".line-height-value"),alignInput:i(".align-input"),baselineInput:i(".baseline-input"),canvas:i(".canvas canvas"),canvasUi:i(".canvas-ui"),rrValue:i(".rr-value"),dprValue:i(".dpr-value"),rrInput:i(".rr-input"),canvasSizeValue:i(".canvas-size-value"),renderPixelValue:i(".render-pixel-value"),zoomValue:i(".zoom-value"),lineStyle:{blAlign:{color:i(".bl-align-color-input"),width:i(".bl-align-width-input"),display:i(".bl-align-display-input")},fontBb:{color:i(".font-color-input"),width:i(".font-width-input"),display:i(".font-display-input")},actualBb:{color:i(".actual-color-input"),width:i(".actual-width-input"),display:i(".actual-display-input")}}};var y=["serif","sans-serif","monospace"],v=[];var T=t=>{e.canvasSizeValue.innerHTML=t.props.rw.toFixed(1)+"x"+t.props.rh.toFixed(1),e.renderPixelValue.innerHTML=(t.props.rw*t.props.rr).toFixed(1)+"x"+(t.props.rh*t.props.rr).toFixed(1)},I=t=>{e.textInput.style.fontFamily=t.font.ff,e.textInput.style.fontStyle=t.font.fs,e.textInput.style.fontWeight=t.font.fw},R=t=>{let p=d=>d.map(n=>{let m=document.createElement("option");return m.value=n,m.innerHTML=n,m});e.ffInput.innerHTML="",e.ffInput.append(...p(y),...p(v)),e.ffInput.value=String(t.font.ff)},X=t=>{e.textInput.value=t.text,I(t),R(t),e.fontSizeInput.value=String(t.font.size),e.fontSizeValue.innerHTML=String(t.font.size),e.lhInput.value=String(t.font.lh),e.lhValue.innerHTML=String(t.font.lh),e.alignInput.value=t.font.align,e.baselineInput.value=t.font.baseline,e.rrValue.innerHTML=String(t.props.rr),e.dprValue.innerHTML=String(window.devicePixelRatio),e.rrInput.value=String(t.props.rr),T(t),e.zoomValue.innerHTML=String(t.props.scaleMp),e.lineStyle.blAlign.color.value=t.props.style.blAlign.color,e.lineStyle.blAlign.width.value=String(t.props.style.blAlign.width),e.lineStyle.blAlign.display.checked=t.props.style.blAlign.display,e.lineStyle.fontBb.color.value=t.props.style.fontBb.color,e.lineStyle.fontBb.width.value=String(t.props.style.fontBb.width),e.lineStyle.fontBb.display.checked=t.props.style.fontBb.display,e.lineStyle.actualBb.color.value=t.props.style.actualBb.color,e.lineStyle.actualBb.width.value=String(t.props.style.actualBb.width),e.lineStyle.actualBb.display.checked=t.props.style.actualBb.display},N=(t,p)=>{let d=p.map(n=>n.fullName);v.splice(0,v.length,...d),R(t)};var $=t=>{e.textInput.addEventListener("input",()=>{t.text=e.textInput.value,t.draw()}),e.ffInput.addEventListener("change",()=>{t.font.ff=e.ffInput.value,I(t),t.draw()}),e.localFontsButton.addEventListener("click",async()=>{window.queryLocalFonts?window.queryLocalFonts().then(n=>{n.length===0?console.warn("Empty array, premission denied. Enable manually in browser"):N(t,n)}).catch(n=>{console.error("Local fonts query failed: %o",n)}):console.warn("Local fonts not supported")}),e.fontSizeInput.addEventListener("input",()=>{t.font.size=Number(e.fontSizeInput.value),e.fontSizeValue.innerHTML=e.fontSizeInput.value,t.draw()}),e.lhInput.addEventListener("input",()=>{t.font.lh=Number(e.lhInput.value),e.lhValue.innerHTML=e.lhInput.value,t.draw()}),e.alignInput.addEventListener("change",()=>{t.font.align=S(e.alignInput.value,b),t.draw()}),e.baselineInput.addEventListener("change",()=>{t.font.baseline=S(e.baselineInput.value,B),t.draw()}),e.rrInput.addEventListener("input",()=>{let n=e.rrInput.value;e.rrValue.innerHTML=n,t.props.rr=Number(n),t.init(),T(t),t.draw()}),window.addEventListener("resize",()=>{t.init(),T(t),t.draw()}),e.canvasUi.addEventListener("contextmenu",n=>{n.preventDefault()});let p=0;e.canvasUi.addEventListener("wheel",n=>{if(n.preventDefault(),n.ctrlKey){p+=-n.deltaY/100;let m=t.props.scaleMp,g=Math.pow(1.4,p);t.props.scaleMp=g,e.zoomValue.innerHTML=t.props.scaleMp.toFixed(2),m-=t.props.scaleMp;let f=t.props.rw*(n.offsetX/t.props.shared.cw),h=t.props.rh*(n.offsetY/t.props.shared.ch);t.init();let w=t.props.rw*(n.offsetX/t.props.shared.cw),c=t.props.rh*(n.offsetY/t.props.shared.ch);t.props.drawX+=w-f,t.props.drawY+=c-h}else{let m=n.deltaX/t.props.scaleMp,g=n.deltaY/t.props.scaleMp;t.props.drawX-=m,t.props.drawY-=g}t.draw()}),e.canvasUi.addEventListener("mousedown",n=>{n.preventDefault(),e.canvasUi.classList.add("grabbing");let m=n.clientX,g=n.clientY,f=t.props.drawX,h=t.props.drawY,w=l=>{l.preventDefault(),t.props.drawX=f+(l.clientX-m)/t.props.scaleMp,t.props.drawY=h+(l.clientY-g)/t.props.scaleMp,t.draw()},c=()=>{e.canvasUi.classList.remove("grabbing"),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",c)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",c)}),["blAlign","fontBb","actualBb"].forEach(n=>{e.lineStyle[n].color.addEventListener("input",()=>{t.props.style[n].color=e.lineStyle[n].color.value,t.draw()}),e.lineStyle[n].width.addEventListener("input",()=>{t.props.style[n].width=Number(e.lineStyle[n].width.value),t.draw()}),e.lineStyle[n].display.addEventListener("input",()=>{t.props.style[n].display=e.lineStyle[n].display.checked,t.draw()})})};var q=30,M=10,r=e.canvas.getContext("2d")??x("ctx died"),o={text:"my honest reaction \u{1F605}\u{1F44C}\u{1F3FD}",font:{fs:"normal",fw:"normal",ff:y[0],size:60,lh:80,align:"start",baseline:"alphabetic"},props:{rw:0,rh:0,drawX:100,drawY:e.canvas.clientHeight-100,scaleMp:1,rr:window.devicePixelRatio,style:{blAlign:{color:"#c800c8",width:.5,display:!0},fontBb:{color:"#f00000",width:.5,display:!0},actualBb:{color:"#000000",width:.5,display:!0}},shared:{cw:0,ch:0}},draw:()=>{},init:()=>{}},C=()=>{let t=r.canvas.clientWidth,p=r.canvas.clientHeight;o.props.rw=t/o.props.scaleMp,o.props.rh=p/o.props.scaleMp,r.canvas.width=t*o.props.rr,r.canvas.height=p*o.props.rr,r.scale(o.props.rr*o.props.scaleMp,o.props.rr*o.props.scaleMp),o.props.shared.cw=t,o.props.shared.ch=p},A=null,O=()=>{typeof A=="number"&&cancelAnimationFrame(A),A=requestAnimationFrame(W)},W=()=>{let{rw:t,rh:p}=o.props,d=(c,l,u)=>{r.textAlign=o.font.align,r.textBaseline=o.font.baseline,r.font=`${o.font.fs} ${o.font.fw} ${o.font.size}px ${o.font.ff}`,r.fillText(c,l,u)},n=(c,l,u)=>{let a=new Path2D;a.moveTo(0,u),a.lineTo(t,u),c===0&&(a.moveTo(l,0),a.lineTo(l,p)),r.strokeStyle=o.props.style.blAlign.color,r.lineWidth=o.props.style.blAlign.width,r.stroke(a)},m=(c,l,u,a)=>{let s=new Path2D;s.moveTo(0,a-l.fontBoundingBoxAscent),s.lineTo(t,a-l.fontBoundingBoxAscent),s.moveTo(0,a+l.fontBoundingBoxDescent),s.lineTo(t,a+l.fontBoundingBoxDescent),r.strokeStyle=o.props.style.fontBb.color,r.lineWidth=o.props.style.fontBb.width,r.stroke(s)},g=(c,l,u,a)=>{let s=new Path2D;s.moveTo(0,a-l.actualBoundingBoxAscent),s.lineTo(t,a-l.actualBoundingBoxAscent),s.moveTo(0,a+l.actualBoundingBoxDescent),s.lineTo(t,a+l.actualBoundingBoxDescent),c===0&&(s.moveTo(u-l.actualBoundingBoxLeft,0),s.lineTo(u-l.actualBoundingBoxLeft,p)),s.moveTo(u+l.actualBoundingBoxRight,0),s.lineTo(u+l.actualBoundingBoxRight,p),r.strokeStyle=o.props.style.actualBb.color,r.lineWidth=o.props.style.actualBb.width,r.stroke(s)},f=0,h=(c,l,u,a)=>{let s=new Path2D,H=q/o.props.scaleMp,D=M/o.props.scaleMp,L=(c===0?a-l.actualBoundingBoxAscent:f)-H,E=u+l.actualBoundingBoxRight+H;s.moveTo(u-l.actualBoundingBoxLeft,L),s.lineTo(u+l.actualBoundingBoxRight,L),s.moveTo(E,a-l.actualBoundingBoxAscent),s.lineTo(E,a+l.actualBoundingBoxDescent),r.globalAlpha=.5,r.strokeStyle=o.props.style.actualBb.color,r.lineWidth=o.props.style.actualBb.width,r.stroke(s),r.globalAlpha=1,r.textAlign="center",r.textBaseline="bottom",r.font=`${o.font.fs} ${o.font.fw} ${o.font.size/2}px ${o.font.ff}`;let z=l.actualBoundingBoxLeft+l.actualBoundingBoxRight,U=u-l.actualBoundingBoxLeft+z/2,F=L-D;r.fillText(`${z.toFixed(1)}px`,U,F);let P=l.actualBoundingBoxAscent+l.actualBoundingBoxDescent,V=E+D,k=a-l.actualBoundingBoxAscent+P/2;r.translate(V,k),r.rotate(90/(180/Math.PI)),r.fillText(`${P.toFixed(1)}px`,0,0),r.rotate(-90/(180/Math.PI)),r.translate(-V,-k),f=F-o.font.size/2};r.clearRect(0,0,t,p),o.text.split(`
`).forEach((c,l)=>{let u=o.props.drawX,a=o.props.drawY+o.font.lh*l;d(c,u,a),r.globalAlpha=.5;let s=r.measureText(c);o.props.style.blAlign.display&&n(l,u,a),o.props.style.fontBb.display&&m(l,s,u,a),o.props.style.actualBb.display&&g(l,s,u,a),r.globalAlpha=1,o.props.style.actualBb.display&&h(l,s,u,a)})};o.draw=O;o.init=C;$(o);C();O();X(o);Y();})();
//# sourceMappingURL=bundle.js.map
