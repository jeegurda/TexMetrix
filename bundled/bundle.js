"use strict";(()=>{var Y=()=>{let t=["actualBoundingBoxAscent","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","emHeightAscent","emHeightDescent","alphabeticBaseline","hangingBaseline","ideographicBaseline","width"],u=[],f=[];t.forEach(l=>l in TextMetrics.prototype?u.push(l):f.push(l)),console.log("Supported: %o. Not supported: %o",u.join(", "),f.join(", "))};var B=(l=>(l.START="start",l.CENTER="center",l.END="end",l))(B||{}),x=(d=>(d.ALPHABETIC="alphabetic",d.BOTTOM="bottom",d.HANGING="hanging",d.IDEOGRAPHIC="ideographic",d.MIDDLE="middle",d.TOP="top",d))(x||{});var E=(t,u)=>{let f=Object.values(u);return f.includes(t)?t:(console.warn("%o does not exist in enum %o. Using %o",t,u,f[0]),f[0])},v=(t="Unknown",u=Error)=>{throw new u(t)};var i=t=>document.querySelector(t)??v(`dom el missing (selector: ${t})`),e={textInput:i(".text-input"),fontSizeInput:i(".font-size-input"),ffInput:i(".font-family-input"),lhInput:i(".line-height-input"),alignInput:i(".align-input"),baselineInput:i(".baseline-input"),canvas:i(".canvas canvas"),canvasUi:i(".canvas-ui"),rrValue:i(".rr-value"),dprValue:i(".dpr-value"),rrInput:i(".rr-input"),canvasSizeValue:i(".canvas-size-value"),renderPixelValue:i(".render-pixel-value"),zoomValue:i(".zoom-value"),lineStyle:{blAlign:{color:i(".bl-align-color-input"),width:i(".bl-align-width-input"),display:i(".bl-align-display-input")},fontBb:{color:i(".font-color-input"),width:i(".font-width-input"),display:i(".font-display-input")},actualBb:{color:i(".actual-color-input"),width:i(".actual-width-input"),display:i(".actual-display-input")}}};var y=t=>{e.canvasSizeValue.innerHTML=t.props.rw.toFixed(1)+"x"+t.props.rh.toFixed(1),e.renderPixelValue.innerHTML=(t.props.rw*t.props.rr).toFixed(1)+"x"+(t.props.rh*t.props.rr).toFixed(1)},S=t=>{e.textInput.style.fontFamily=t.font.ff,e.textInput.style.fontStyle=t.font.fs,e.textInput.style.fontWeight=t.font.fw},k=t=>{e.textInput.value=t.text,S(t),e.ffInput.value=String(t.font.ff),e.fontSizeInput.value=String(t.font.size),e.lhInput.value=String(t.font.lh),e.alignInput.value=t.font.align,e.baselineInput.value=t.font.baseline,e.rrValue.innerHTML=String(t.props.rr),e.dprValue.innerHTML=String(window.devicePixelRatio),e.rrInput.value=String(t.props.rr),y(t),e.zoomValue.innerHTML=String(t.props.scaleMp),e.lineStyle.blAlign.color.value=t.props.style.blAlign.color,e.lineStyle.blAlign.width.value=String(t.props.style.blAlign.width),e.lineStyle.blAlign.display.checked=t.props.style.blAlign.display,e.lineStyle.fontBb.color.value=t.props.style.fontBb.color,e.lineStyle.fontBb.width.value=String(t.props.style.fontBb.width),e.lineStyle.fontBb.display.checked=t.props.style.fontBb.display,e.lineStyle.actualBb.color.value=t.props.style.actualBb.color,e.lineStyle.actualBb.width.value=String(t.props.style.actualBb.width),e.lineStyle.actualBb.display.checked=t.props.style.actualBb.display};var X=t=>{e.textInput.addEventListener("input",()=>{t.text=e.textInput.value,t.draw()}),e.ffInput.addEventListener("change",()=>{t.font.ff=e.ffInput.value,S(t),t.draw()}),e.fontSizeInput.addEventListener("input",()=>{t.font.size=Number(e.fontSizeInput.value),t.draw()}),e.lhInput.addEventListener("input",()=>{t.font.lh=Number(e.lhInput.value),t.draw()}),e.alignInput.addEventListener("change",()=>{t.font.align=E(e.alignInput.value,B),t.draw()}),e.baselineInput.addEventListener("change",()=>{t.font.baseline=E(e.baselineInput.value,x),t.draw()}),e.rrInput.addEventListener("input",()=>{let l=e.rrInput.value;e.rrValue.innerHTML=l,t.props.rr=Number(l),t.init(),y(t),t.draw()}),window.addEventListener("resize",()=>{t.init(),y(t),t.draw()}),e.canvasUi.addEventListener("contextmenu",l=>{l.preventDefault()});let u=0;e.canvasUi.addEventListener("wheel",l=>{if(l.preventDefault(),l.ctrlKey){u+=-l.deltaY/100;let m=t.props.scaleMp,g=Math.pow(1.4,u);t.props.scaleMp=g,e.zoomValue.innerHTML=t.props.scaleMp.toFixed(2),m-=t.props.scaleMp;let d=t.props.rw*(l.offsetX/t.props.shared.cw),h=t.props.rh*(l.offsetY/t.props.shared.ch);t.init();let w=t.props.rw*(l.offsetX/t.props.shared.cw),c=t.props.rh*(l.offsetY/t.props.shared.ch);t.props.drawX+=w-d,t.props.drawY+=c-h}else{let m=l.deltaX/t.props.scaleMp,g=l.deltaY/t.props.scaleMp;t.props.drawX-=m,t.props.drawY-=g}t.draw()}),e.canvasUi.addEventListener("mousedown",l=>{l.preventDefault(),e.canvasUi.classList.add("grabbing");let m=l.clientX,g=l.clientY,d=t.props.drawX,h=t.props.drawY,w=o=>{o.preventDefault(),t.props.drawX=d+(o.clientX-m)/t.props.scaleMp,t.props.drawY=h+(o.clientY-g)/t.props.scaleMp,t.draw()},c=()=>{e.canvasUi.classList.remove("grabbing"),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",c)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",c)}),["blAlign","fontBb","actualBb"].forEach(l=>{e.lineStyle[l].color.addEventListener("input",()=>{t.props.style[l].color=e.lineStyle[l].color.value,t.draw()}),e.lineStyle[l].width.addEventListener("input",()=>{t.props.style[l].width=Number(e.lineStyle[l].width.value),t.draw()}),e.lineStyle[l].display.addEventListener("input",()=>{t.props.style[l].display=e.lineStyle[l].display.checked,t.draw()})})};var R=30,V=10,r=e.canvas.getContext("2d")??v("ctx died"),n={text:"my honest reaction \u{1F605}\u{1F44C}\u{1F3FD}",font:{fs:"normal",fw:"normal",ff:"serif",size:60,lh:80,align:"start",baseline:"alphabetic"},props:{rw:0,rh:0,drawX:100,drawY:e.canvas.clientHeight-100,scaleMp:1,rr:window.devicePixelRatio,style:{blAlign:{color:"#c800c8",width:.5,display:!0},fontBb:{color:"#f00000",width:.5,display:!0},actualBb:{color:"#000000",width:.5,display:!0}},shared:{cw:0,ch:0}},draw:()=>{},init:()=>{}},F=()=>{let t=r.canvas.clientWidth,u=r.canvas.clientHeight;n.props.rw=t/n.props.scaleMp,n.props.rh=u/n.props.scaleMp,r.canvas.width=t*n.props.rr,r.canvas.height=u*n.props.rr,r.scale(n.props.rr*n.props.scaleMp,n.props.rr*n.props.scaleMp),n.props.shared.cw=t,n.props.shared.ch=u},I=null,$=()=>{typeof I=="number"&&cancelAnimationFrame(I),I=requestAnimationFrame(N)},N=()=>{let{rw:t,rh:u}=n.props,f=(c,o,s)=>{r.textAlign=n.font.align,r.textBaseline=n.font.baseline,r.font=`${n.font.fs} ${n.font.fw} ${n.font.size}px ${n.font.ff}`,r.fillText(c,o,s)},l=(c,o,s)=>{let a=new Path2D;a.moveTo(0,s),a.lineTo(t,s),c===0&&(a.moveTo(o,0),a.lineTo(o,u)),r.strokeStyle=n.props.style.blAlign.color,r.lineWidth=n.props.style.blAlign.width,r.stroke(a)},m=(c,o,s,a)=>{let p=new Path2D;p.moveTo(0,a-o.fontBoundingBoxAscent),p.lineTo(t,a-o.fontBoundingBoxAscent),p.moveTo(0,a+o.fontBoundingBoxDescent),p.lineTo(t,a+o.fontBoundingBoxDescent),r.strokeStyle=n.props.style.fontBb.color,r.lineWidth=n.props.style.fontBb.width,r.stroke(p)},g=(c,o,s,a)=>{let p=new Path2D;p.moveTo(0,a-o.actualBoundingBoxAscent),p.lineTo(t,a-o.actualBoundingBoxAscent),p.moveTo(0,a+o.actualBoundingBoxDescent),p.lineTo(t,a+o.actualBoundingBoxDescent),c===0&&(p.moveTo(s-o.actualBoundingBoxLeft,0),p.lineTo(s-o.actualBoundingBoxLeft,u)),p.moveTo(s+o.actualBoundingBoxRight,0),p.lineTo(s+o.actualBoundingBoxRight,u),r.strokeStyle=n.props.style.actualBb.color,r.lineWidth=n.props.style.actualBb.width,r.stroke(p)},d=0,h=(c,o,s,a)=>{let p=c===0?a-o.actualBoundingBoxAscent:d,b=new Path2D,T=p-R/n.props.scaleMp,L=s+o.actualBoundingBoxRight+R/n.props.scaleMp;b.moveTo(s-o.actualBoundingBoxLeft,T),b.lineTo(s+o.actualBoundingBoxRight,T),b.moveTo(L,a-o.actualBoundingBoxAscent),b.lineTo(L,a+o.actualBoundingBoxDescent),r.globalAlpha=.5,r.strokeStyle=n.props.style.actualBb.color,r.lineWidth=n.props.style.actualBb.width,r.stroke(b),r.globalAlpha=1,r.textAlign="center",r.textBaseline="bottom",r.font=`${n.font.fs} ${n.font.fw} ${n.font.size/2}px ${n.font.ff}`;let A=o.actualBoundingBoxLeft+o.actualBoundingBoxRight,C=s-o.actualBoundingBoxLeft+A/2,H=T-V/n.props.scaleMp;r.fillText(`${A.toFixed(1)}px`,C,H);let D=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,z=L+V/n.props.scaleMp,P=a-o.actualBoundingBoxAscent+D/2;r.translate(z,P),r.rotate(90/(180/Math.PI)),r.fillText(`${D.toFixed(1)}px`,0,0),r.rotate(-90/(180/Math.PI)),r.translate(-z,-P),d=H-n.font.size/2};r.clearRect(0,0,t,u),n.text.split(`
`).forEach((c,o)=>{let s=n.props.drawX,a=n.props.drawY+n.font.lh*o;f(c,s,a),r.globalAlpha=.5;let p=r.measureText(c);n.props.style.blAlign.display&&l(o,s,a),n.props.style.fontBb.display&&m(o,p,s,a),n.props.style.actualBb.display&&g(o,p,s,a),r.globalAlpha=1,n.props.style.actualBb.display&&h(o,p,s,a)})};n.draw=$;n.init=F;X(n);F();$();k(n);Y();})();
//# sourceMappingURL=bundle.js.map
