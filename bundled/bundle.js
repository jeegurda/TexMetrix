"use strict";(()=>{var I=()=>{let e=["actualBoundingBoxAscent","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","emHeightAscent","emHeightDescent","alphabeticBaseline","hangingBaseline","ideographicBaseline","width"],l=[],o=[];e.forEach(i=>i in TextMetrics.prototype?l.push(i):o.push(i)),console.log("Supported: %o. Not supported: %o",l.join(", "),o.join(", "))};var g=(i=>(i.START="start",i.CENTER="center",i.END="end",i))(g||{}),m=(p=>(p.ALPHABETIC="alphabetic",p.BOTTOM="bottom",p.HANGING="hanging",p.IDEOGRAPHIC="ideographic",p.MIDDLE="middle",p.TOP="top",p))(m||{});var v=(e,l)=>{let o=Object.values(l);return o.includes(e)?e:(console.warn("%o does not exist in enum %o. Using %o",e,l,o[0]),o[0])},B=(e="Unknown",l=Error)=>{throw new l(e)};var a=e=>document.querySelector(e)??B(`dom el missing (selector: ${e})`),t={textInput:a(".text-input"),fontSizeInput:a(".font-size-input"),alignInput:a(".align-input"),baselineInput:a(".baseline-input"),canvas:a(".canvas canvas"),canvasUi:a(".canvas-ui"),rrValue:a(".rr-value"),dprValue:a(".dpr-value"),rrInput:a(".rr-input"),canvasSizeValue:a(".canvas-size-value"),renderPixelValue:a(".render-pixel-value"),zoomValue:a(".zoom-value"),lineInputs:{blAlign:{color:a(".bl-align-color-input"),width:a(".bl-align-width-input")},fontBb:{color:a(".font-color-input"),width:a(".font-width-input")},actualBb:{color:a(".actual-color-input"),width:a(".actual-width-input")}}};var E=e=>{t.textInput.addEventListener("input",o=>{e.props.text=t.textInput.value,e.draw()}),t.fontSizeInput.addEventListener("input",o=>{e.props.fs=Number(t.fontSizeInput.value),e.draw()}),t.alignInput.addEventListener("change",o=>{e.props.align=v(t.alignInput.value,g),e.draw()}),t.baselineInput.addEventListener("change",o=>{e.props.baseline=v(t.baselineInput.value,m),e.draw()}),t.rrInput.addEventListener("input",o=>{let i=t.rrInput.value;t.rrValue.innerHTML=i,e.props.rr=Number(i),e.init(),t.canvasSizeValue.innerHTML=`${e.props.rw.toFixed(1)}x${e.props.rh.toFixed(1)}`,e.draw()}),window.addEventListener("resize",()=>{e.init(),t.canvasSizeValue.innerHTML=`${e.props.rw.toFixed(1)}x${e.props.rh.toFixed(1)}`,e.draw()}),t.canvasUi.addEventListener("contextmenu",o=>{o.preventDefault()});let l=0;t.canvasUi.addEventListener("wheel",o=>{if(o.preventDefault(),o.ctrlKey){l+=-o.deltaY/100;let i=e.props.scaleMp,s=Math.pow(1.4,l);e.props.scaleMp=s,t.zoomValue.innerHTML=e.props.scaleMp.toFixed(2),i-=e.props.scaleMp;let d=e.props.rw*(o.offsetX/e.props.rest.cw),p=e.props.rh*(o.offsetY/e.props.rest.ch);e.init();let c=e.props.rw*(o.offsetX/e.props.rest.cw),u=e.props.rh*(o.offsetY/e.props.rest.ch);e.props.drawX+=c-d,e.props.drawY+=u-p}else{let i=o.deltaX/e.props.scaleMp,s=o.deltaY/e.props.scaleMp;e.props.drawX-=i,e.props.drawY-=s}e.draw()}),t.canvasUi.addEventListener("mousedown",o=>{o.preventDefault(),t.canvasUi.classList.add("grabbing");let i=o.clientX,s=o.clientY,d=e.props.drawX,p=e.props.drawY,c=w=>{w.preventDefault(),e.props.drawX=d+(w.clientX-i)/e.props.scaleMp,e.props.drawY=p+(w.clientY-s)/e.props.scaleMp,e.draw()},u=w=>{t.canvasUi.classList.remove("grabbing"),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",u)};window.addEventListener("mousemove",c),window.addEventListener("mouseup",u)}),t.lineInputs.blAlign.color.addEventListener("input",()=>{e.props.lines.blAlign.color=t.lineInputs.blAlign.color.value,e.draw()}),t.lineInputs.blAlign.width.addEventListener("input",()=>{e.props.lines.blAlign.width=Number(t.lineInputs.blAlign.width.value),e.draw()}),t.lineInputs.fontBb.color.addEventListener("input",()=>{e.props.lines.fontBb.color=t.lineInputs.fontBb.color.value,e.draw()}),t.lineInputs.fontBb.color.addEventListener("input",()=>{e.props.lines.fontBb.width=Number(t.lineInputs.fontBb.width.value),e.draw()}),t.lineInputs.actualBb.color.addEventListener("input",()=>{e.props.lines.actualBb.color=t.lineInputs.actualBb.color.value,e.draw()}),t.lineInputs.actualBb.color.addEventListener("input",()=>{e.props.lines.actualBb.width=Number(t.lineInputs.actualBb.width.value),e.draw()})};var y="sans-serif",r=t.canvas.getContext("2d")??B("ctx died"),n={props:{rw:0,rh:0,drawX:100,drawY:t.canvas.clientHeight-100,scaleMp:1,text:"my honest reaction \u{1F605}\u{1F44C}\u{1F3FD}",fs:60,align:"start",baseline:"alphabetic",rr:window.devicePixelRatio,lines:{blAlign:{color:"#c800c8",width:.5},fontBb:{color:"#f00000",width:.5},actualBb:{color:"#000000",width:.5}},rest:{}},draw:()=>{},init:()=>{}},A=()=>{let e=r.canvas.clientWidth,l=r.canvas.clientHeight;n.props.rw=e/n.props.scaleMp,n.props.rh=l/n.props.scaleMp,r.canvas.width=e*n.props.rr,r.canvas.height=l*n.props.rr,r.scale(n.props.rr*n.props.scaleMp,n.props.rr*n.props.scaleMp),n.props.rest.cw=e,n.props.rest.ch=l},h=null,S=()=>{typeof h=="number"&&cancelAnimationFrame(h),h=requestAnimationFrame(Y)},Y=()=>{let{rw:e,rh:l,drawX:o,drawY:i}=n.props;r.textAlign=n.props.align,r.textBaseline=n.props.baseline,r.clearRect(0,0,e,l),r.font=`${n.props.fs}px ${y}`;let s=r.measureText(n.props.text);r.fillText(n.props.text,o,i),r.globalAlpha=.5;let d=new Path2D;d.moveTo(0,i),d.lineTo(e,i),d.moveTo(o,0),d.lineTo(o,l),r.strokeStyle=n.props.lines.blAlign.color,r.lineWidth=n.props.lines.blAlign.width,r.stroke(d);let p=new Path2D;p.moveTo(0,i-s.fontBoundingBoxAscent),p.lineTo(e,i-s.fontBoundingBoxAscent),p.moveTo(0,i+s.fontBoundingBoxDescent),p.lineTo(e,i+s.fontBoundingBoxDescent),r.strokeStyle=n.props.lines.fontBb.color,r.lineWidth=n.props.lines.fontBb.width,r.stroke(p);let c=new Path2D;c.moveTo(0,i-s.actualBoundingBoxAscent),c.lineTo(e,i-s.actualBoundingBoxAscent),c.moveTo(0,i+s.actualBoundingBoxDescent),c.lineTo(e,i+s.actualBoundingBoxDescent),c.moveTo(o-s.actualBoundingBoxLeft,0),c.lineTo(o-s.actualBoundingBoxLeft,l),c.moveTo(o+s.actualBoundingBoxRight,0),c.lineTo(o+s.actualBoundingBoxRight,l),r.strokeStyle=n.props.lines.actualBb.color,r.lineWidth=n.props.lines.actualBb.width,r.stroke(c),r.globalAlpha=1;let u=new Path2D,w=i-s.actualBoundingBoxAscent-30/n.props.scaleMp*2,x=o+s.actualBoundingBoxRight+30/n.props.scaleMp*2;u.moveTo(o-s.actualBoundingBoxLeft,w),u.lineTo(o+s.actualBoundingBoxRight,w),u.moveTo(x,i-s.actualBoundingBoxAscent),u.lineTo(x,i+s.actualBoundingBoxDescent),r.strokeStyle=n.props.lines.actualBb.color,r.lineWidth=n.props.lines.actualBb.width,r.stroke(u),r.textAlign="center",r.textBaseline="bottom",r.font=`${n.props.fs/2}px sans-serif`;let b=s.actualBoundingBoxLeft+s.actualBoundingBoxRight,H=o-s.actualBoundingBoxLeft+b/2,D=w-10/n.props.scaleMp*2;r.fillText(`${b.toFixed(1)}px`,H,D);let f=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent,T=x+10/n.props.scaleMp*2,L=i-s.actualBoundingBoxAscent+f/2;r.translate(T,L),r.rotate(90/(180/Math.PI)),r.fillText(`${f.toFixed(1)}px`,0,0),r.rotate(-90/(180/Math.PI)),r.translate(-T,-L)};n.draw=S;n.init=A;var P=()=>{t.textInput.value=n.props.text,t.rrInput.value=String(n.props.rr),t.rrValue.innerHTML=String(n.props.rr),t.dprValue.innerHTML=String(window.devicePixelRatio),t.canvasSizeValue.innerHTML=`${n.props.rw.toFixed(1)}x${n.props.rh.toFixed(1)}`,t.renderPixelValue.innerHTML=`${(n.props.rw*n.props.rr).toFixed(1)}x${(n.props.rh*n.props.rr).toFixed(1)}`,t.zoomValue.innerHTML=String(n.props.scaleMp),t.lineInputs.blAlign.color.value=n.props.lines.blAlign.color,t.lineInputs.blAlign.width.value=String(n.props.lines.blAlign.width),t.lineInputs.fontBb.color.value=n.props.lines.fontBb.color,t.lineInputs.fontBb.width.value=String(n.props.lines.fontBb.width),t.lineInputs.actualBb.color.value=n.props.lines.actualBb.color,t.lineInputs.actualBb.width.value=String(n.props.lines.actualBb.width)};E(n);A();S();P();I();window.M=n;})();
//# sourceMappingURL=bundle.js.map
