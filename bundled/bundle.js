"use strict";(()=>{var k=()=>{let t=["actualBoundingBoxAscent","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","emHeightAscent","emHeightDescent","alphabeticBaseline","hangingBaseline","ideographicBaseline","width"],u=[],f=[];t.forEach(l=>l in TextMetrics.prototype?u.push(l):f.push(l)),console.log("Supported: %o. Not supported: %o",u.join(", "),f.join(", "))};var b=(l=>(l.START="start",l.CENTER="center",l.END="end",l))(b||{}),B=(d=>(d.ALPHABETIC="alphabetic",d.BOTTOM="bottom",d.HANGING="hanging",d.IDEOGRAPHIC="ideographic",d.MIDDLE="middle",d.TOP="top",d))(B||{});var L=(t,u)=>{let f=Object.values(u);return f.includes(t)?t:(console.warn("%o does not exist in enum %o. Using %o",t,u,f[0]),f[0])},x=(t="Unknown",u=Error)=>{throw new u(t)};var s=t=>document.querySelector(t)??x(`dom el missing (selector: ${t})`),e={textInput:s(".text-input"),fontSizeInput:s(".font-size-input"),ffInput:s(".font-family-input"),lhInput:s(".line-height-input"),alignInput:s(".align-input"),baselineInput:s(".baseline-input"),canvas:s(".canvas canvas"),canvasUi:s(".canvas-ui"),rrValue:s(".rr-value"),dprValue:s(".dpr-value"),rrInput:s(".rr-input"),canvasSizeValue:s(".canvas-size-value"),renderPixelValue:s(".render-pixel-value"),zoomValue:s(".zoom-value"),lineStyle:{blAlign:{color:s(".bl-align-color-input"),width:s(".bl-align-width-input"),display:s(".bl-align-display-input")},fontBb:{color:s(".font-color-input"),width:s(".font-width-input"),display:s(".font-display-input")},actualBb:{color:s(".actual-color-input"),width:s(".actual-width-input"),display:s(".actual-display-input")}}};var v=t=>{e.canvasSizeValue.innerHTML=t.props.rw.toFixed(1)+"x"+t.props.rh.toFixed(1),e.renderPixelValue.innerHTML=(t.props.rw*t.props.rr).toFixed(1)+"x"+(t.props.rh*t.props.rr).toFixed(1)},E=t=>{e.textInput.style.fontFamily=t.font.ff,e.textInput.style.fontStyle=t.font.fs,e.textInput.style.fontWeight=t.font.fw},X=t=>{e.textInput.value=t.text,E(t),e.ffInput.value=String(t.font.ff),e.fontSizeInput.value=String(t.font.size),e.lhInput.value=String(t.font.lh),e.alignInput.value=t.font.align,e.baselineInput.value=t.font.baseline,e.rrValue.innerHTML=String(t.props.rr),e.dprValue.innerHTML=String(window.devicePixelRatio),e.rrInput.value=String(t.props.rr),v(t),e.zoomValue.innerHTML=String(t.props.scaleMp),e.lineStyle.blAlign.color.value=t.props.style.blAlign.color,e.lineStyle.blAlign.width.value=String(t.props.style.blAlign.width),e.lineStyle.blAlign.display.checked=t.props.style.blAlign.display,e.lineStyle.fontBb.color.value=t.props.style.fontBb.color,e.lineStyle.fontBb.width.value=String(t.props.style.fontBb.width),e.lineStyle.fontBb.display.checked=t.props.style.fontBb.display,e.lineStyle.actualBb.color.value=t.props.style.actualBb.color,e.lineStyle.actualBb.width.value=String(t.props.style.actualBb.width),e.lineStyle.actualBb.display.checked=t.props.style.actualBb.display};var R=t=>{e.textInput.addEventListener("input",()=>{t.text=e.textInput.value,t.draw()}),e.ffInput.addEventListener("change",()=>{t.font.ff=e.ffInput.value,E(t),t.draw()}),e.fontSizeInput.addEventListener("input",()=>{t.font.size=Number(e.fontSizeInput.value),t.draw()}),e.lhInput.addEventListener("input",()=>{t.font.lh=Number(e.lhInput.value),t.draw()}),e.alignInput.addEventListener("change",()=>{t.font.align=L(e.alignInput.value,b),t.draw()}),e.baselineInput.addEventListener("change",()=>{t.font.baseline=L(e.baselineInput.value,B),t.draw()}),e.rrInput.addEventListener("input",()=>{let l=e.rrInput.value;e.rrValue.innerHTML=l,t.props.rr=Number(l),t.init(),v(t),t.draw()}),window.addEventListener("resize",()=>{t.init(),v(t),t.draw()}),e.canvasUi.addEventListener("contextmenu",l=>{l.preventDefault()});let u=0;e.canvasUi.addEventListener("wheel",l=>{if(l.preventDefault(),l.ctrlKey){u+=-l.deltaY/100;let m=t.props.scaleMp,g=Math.pow(1.4,u);t.props.scaleMp=g,e.zoomValue.innerHTML=t.props.scaleMp.toFixed(2),m-=t.props.scaleMp;let d=t.props.rw*(l.offsetX/t.props.shared.cw),h=t.props.rh*(l.offsetY/t.props.shared.ch);t.init();let w=t.props.rw*(l.offsetX/t.props.shared.cw),c=t.props.rh*(l.offsetY/t.props.shared.ch);t.props.drawX+=w-d,t.props.drawY+=c-h}else{let m=l.deltaX/t.props.scaleMp,g=l.deltaY/t.props.scaleMp;t.props.drawX-=m,t.props.drawY-=g}t.draw()}),e.canvasUi.addEventListener("mousedown",l=>{l.preventDefault(),e.canvasUi.classList.add("grabbing");let m=l.clientX,g=l.clientY,d=t.props.drawX,h=t.props.drawY,w=o=>{o.preventDefault(),t.props.drawX=d+(o.clientX-m)/t.props.scaleMp,t.props.drawY=h+(o.clientY-g)/t.props.scaleMp,t.draw()},c=()=>{e.canvasUi.classList.remove("grabbing"),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",c)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",c)}),["blAlign","fontBb","actualBb"].forEach(l=>{e.lineStyle[l].color.addEventListener("input",()=>{t.props.style[l].color=e.lineStyle[l].color.value,t.draw()}),e.lineStyle[l].width.addEventListener("input",()=>{t.props.style[l].width=Number(e.lineStyle[l].width.value),t.draw()}),e.lineStyle[l].display.addEventListener("input",()=>{t.props.style[l].display=e.lineStyle[l].display.checked,t.draw()})})};var C=30,N=10,r=e.canvas.getContext("2d")??x("ctx died"),n={text:"my honest reaction \u{1F605}\u{1F44C}\u{1F3FD}",font:{fs:"normal",fw:"normal",ff:"serif",size:60,lh:80,align:"start",baseline:"alphabetic"},props:{rw:0,rh:0,drawX:100,drawY:e.canvas.clientHeight-100,scaleMp:1,rr:window.devicePixelRatio,style:{blAlign:{color:"#c800c8",width:.5,display:!0},fontBb:{color:"#f00000",width:.5,display:!0},actualBb:{color:"#000000",width:.5,display:!0}},shared:{cw:0,ch:0}},draw:()=>{},init:()=>{}},V=()=>{let t=r.canvas.clientWidth,u=r.canvas.clientHeight;n.props.rw=t/n.props.scaleMp,n.props.rh=u/n.props.scaleMp,r.canvas.width=t*n.props.rr,r.canvas.height=u*n.props.rr,r.scale(n.props.rr*n.props.scaleMp,n.props.rr*n.props.scaleMp),n.props.shared.cw=t,n.props.shared.ch=u},S=null,F=()=>{typeof S=="number"&&cancelAnimationFrame(S),S=requestAnimationFrame(U)},U=()=>{let{rw:t,rh:u}=n.props,f=(c,o,p)=>{r.textAlign=n.font.align,r.textBaseline=n.font.baseline,r.font=`${n.font.fs} ${n.font.fw} ${n.font.size}px ${n.font.ff}`,r.fillText(c,o,p)},l=(c,o,p)=>{let a=new Path2D;a.moveTo(0,p),a.lineTo(t,p),c===0&&(a.moveTo(o,0),a.lineTo(o,u)),r.strokeStyle=n.props.style.blAlign.color,r.lineWidth=n.props.style.blAlign.width,r.stroke(a)},m=(c,o,p,a)=>{let i=new Path2D;i.moveTo(0,a-o.fontBoundingBoxAscent),i.lineTo(t,a-o.fontBoundingBoxAscent),i.moveTo(0,a+o.fontBoundingBoxDescent),i.lineTo(t,a+o.fontBoundingBoxDescent),r.strokeStyle=n.props.style.fontBb.color,r.lineWidth=n.props.style.fontBb.width,r.stroke(i)},g=(c,o,p,a)=>{let i=new Path2D;i.moveTo(0,a-o.actualBoundingBoxAscent),i.lineTo(t,a-o.actualBoundingBoxAscent),i.moveTo(0,a+o.actualBoundingBoxDescent),i.lineTo(t,a+o.actualBoundingBoxDescent),c===0&&(i.moveTo(p-o.actualBoundingBoxLeft,0),i.lineTo(p-o.actualBoundingBoxLeft,u)),i.moveTo(p+o.actualBoundingBoxRight,0),i.lineTo(p+o.actualBoundingBoxRight,u),r.strokeStyle=n.props.style.actualBb.color,r.lineWidth=n.props.style.actualBb.width,r.stroke(i)},d=0,h=(c,o,p,a)=>{let i=new Path2D,I=C/n.props.scaleMp,A=N/n.props.scaleMp,y=(c===0?a-o.actualBoundingBoxAscent:d)-I,T=p+o.actualBoundingBoxRight+I;i.moveTo(p-o.actualBoundingBoxLeft,y),i.lineTo(p+o.actualBoundingBoxRight,y),i.moveTo(T,a-o.actualBoundingBoxAscent),i.lineTo(T,a+o.actualBoundingBoxDescent),r.globalAlpha=.5,r.strokeStyle=n.props.style.actualBb.color,r.lineWidth=n.props.style.actualBb.width,r.stroke(i),r.globalAlpha=1,r.textAlign="center",r.textBaseline="bottom",r.font=`${n.font.fs} ${n.font.fw} ${n.font.size/2}px ${n.font.ff}`;let H=o.actualBoundingBoxLeft+o.actualBoundingBoxRight,$=p-o.actualBoundingBoxLeft+H/2,D=y-A;r.fillText(`${H.toFixed(1)}px`,$,D);let z=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,P=T+A,Y=a-o.actualBoundingBoxAscent+z/2;r.translate(P,Y),r.rotate(90/(180/Math.PI)),r.fillText(`${z.toFixed(1)}px`,0,0),r.rotate(-90/(180/Math.PI)),r.translate(-P,-Y),d=D-n.font.size/2};r.clearRect(0,0,t,u),n.text.split(`
`).forEach((c,o)=>{let p=n.props.drawX,a=n.props.drawY+n.font.lh*o;f(c,p,a),r.globalAlpha=.5;let i=r.measureText(c);n.props.style.blAlign.display&&l(o,p,a),n.props.style.fontBb.display&&m(o,i,p,a),n.props.style.actualBb.display&&g(o,i,p,a),r.globalAlpha=1,n.props.style.actualBb.display&&h(o,i,p,a)})};n.draw=F;n.init=V;R(n);V();F();X(n);k();})();
//# sourceMappingURL=bundle.js.map
